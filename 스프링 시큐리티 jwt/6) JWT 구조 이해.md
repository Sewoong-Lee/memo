## 6) JWT 구조 이해



제이슨 캑체로 안전하게 전송하기 위한 방식

서명으로 신회성이 있다

RSA 방식을 사용

서명된 토큰이 중요!!

토큰에는 그 안에 무결성을 확인 할 수 있게 해준다.



jwt의 구조

xxxx(헤더 : 서명의 알고리즘).yyyyy(페이로드 : 데이터).zzzzz(시그니처 : 서명)



헤더의 제이슨은 베이스54url로 인코딩 되어있다. (암호화와 복호화)



페이로드는 클레임을 가지고 있다.

등록된 클레임 발행자 만료시간 주제 를 가지고 있다.

개인클레임을 가지고 있다 (유저 정보)



시그니처에는 헤더와 정보와 키를 암호화한 내용이 들어감



---

서버와 클라이언트가 있다.



클라이언트가 아이디와 비번을 로그인하러 보냈다.

서버는 세션이 아닌 jwt 발행



로그인시!!?

서버가 헤더, 페이로드, 시그니처를 만든다

헤더에는 HS256으로 서명을 했다는 뜻

페이로드에는 유저 정보가 들어간다

시그니처는 헤더와 페이로드를 더해서 서버만 아는 키값(코스)과 HS256으로 암호화(복호화x) 

각각을 베이스64로 인코딩 후 클라이언트에 전달

전달받은 클라이언트는 이 정보를 로컬스토리지 등에 저장

클라이언트는 요청을 jwt를 같이 보냄

서버는 jwt를 받고 신뢰가 있는지 검증

서버는 받은 헤더와 페이로드를 서버키값(코스)으로 똑같이 암호화를 해본다.

시그니처와 같으면 통과

페이로드의 유저정보로 검색후 전달한다.





jwt에 헤더.페이로드.시그니처 

시그니처는 헤더 + 페이로드 + 코스키값 을 hs256으로 암호화



만약 RSA를 쓰면

헤더에 RSA를 적고

페이로드에 유저정보를 적고

시그니처에는 헤더와 페이로드를 서버 개인키로 잠근다

이후 클라이언트에 전달

클라이언트가 요청할때 서버가 받으면 공개키로 시그니처를 열어보면 된다.

















